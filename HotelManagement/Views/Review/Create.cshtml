@model HotelManagement.ViewModels.CreateReviewViewModel

@{
    ViewData["Title"] = "Dodaj opinię";
}

<h2 class="mb-4">Dodaj opinię</h2>

<div class="card shadow-sm border-0">
    <div class="card-body">

        <form asp-action="Create" method="post">
            <input type="hidden" asp-for="ReservationId" />

            @foreach (var field in new[] {
                        ("Cleanliness","Czystość"),
                        ("Comfort","Komfort"),
                        ("Staff","Obsługa"),
                        ("Location","Lokalizacja"),
                        ("ValueForMoney","Cena / jakość")
                        })
            {
                <div class="mb-4">
                    <label class="form-label fw-semibold">@field.Item2</label>

                    <div class="d-flex align-items-center gap-3">
                        <!-- SUWAK -->
                        <input type="range"
                               min="1"
                               max="5"
                               step="1"
                               value="3"
                               name="@field.Item1"
                               class="form-range rating-range"
                               oninput="updateStars(this)" />

                        <!-- GWIAZDKI -->
                        <div class="rating-stars fs-5 text-warning"
                             data-value="3">
                            ★★★☆☆
                        </div>

                        <!-- LICZBA -->
                        <span class="badge bg-primary-subtle text-primary fw-semibold">
                            <span class="rating-value">3</span>/5
                        </span>
                    </div>
                </div>
            }

            <div class="mb-4">
                <label class="form-label fw-semibold">Komentarz (opcjonalnie)</label>
                <textarea asp-for="Comment"
                          class="form-control"
                          rows="4"
                          placeholder="Podziel się swoją opinią..."></textarea>
            </div>

            <div class="d-flex justify-content-end">
                <button type="submit" class="btn btn-primary px-4">
                    <i class="bi bi-star-fill me-1"></i>
                    Zapisz opinię
                </button>
            </div>
        </form>

    </div>
</div>

@section Scripts {
    <script>
        function updateStars(range) {
            const container = range.closest(".mb-4");
            const value = range.value;

            const stars = container.querySelector(".rating-stars");
            const valueLabel = container.querySelector(".rating-value");

            let starsText = "";
            for (let i = 1; i <= 5; i++) {
                starsText += i <= value ? "★" : "☆";
            }

            stars.textContent = starsText;
            valueLabel.textContent = value;
        }

        // Init dla wszystkich suwaków
        document.querySelectorAll(".rating-range").forEach(r => updateStars(r));
    </script>
}

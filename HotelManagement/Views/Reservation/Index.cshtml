@model IEnumerable<HotelManagement.Models.Reservation>

@if (TempData["Notification"] != null)
{
    <div class="alert alert-success text-center fixed-top mt-3 mx-auto shadow" style="width: 50%; z-index: 9999;">
        @TempData["Notification"]
    </div>

    <script>
        setTimeout(function () {
            document.querySelector('.alert').style.display = 'none';
        }, 4000); // znika po 4 sekundach
    </script>
}

@{
    ViewData["Title"] = "Rezerwacje";
}

<div class="container mt-5">
    <h2 class="text-center mb-4">Rezerwacje</h2>

    <div class="text-end my-4">
        <h5 class="mb-3">
            <strong>Dzisiejsza data:</strong> <span class="fw-normal">@ViewBag.TodayDate</span>
        </h5>

        <a asp-action="CreateGuest" class="btn btn-lg btn-primary shadow-sm">
            <i class="bi bi-calendar-plus me-2"></i> Załóż rezerwację
        </a>
    </div>

    <!-- Zakładki -->
    <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
            <a class="nav-link active" id="arrivals-tab" data-bs-toggle="tab" href="#arrivals" role="tab" aria-controls="arrivals" aria-selected="true">Przyjazdy</a>
        </li>
        <li class="nav-item" role="presentation">
            <a class="nav-link" id="stay-tab" data-bs-toggle="tab" href="#stay" role="tab" aria-controls="stay" aria-selected="false">Pobyty</a>
        </li>
        <li class="nav-item" role="presentation">
            <a class="nav-link" id="departures-tab" data-bs-toggle="tab" href="#departures" role="tab" aria-controls="departures" aria-selected="false">Wyjazdy</a>
        </li>
    </ul>

    <!-- Treść zakładek -->
    <div class="tab-content" id="myTabContent">
        <!-- Przyjazdy -->
        <div class="tab-pane fade show active" id="arrivals" role="tabpanel" aria-labelledby="arrivals-tab">
            <h3 class="mt-3">Przyjazdy</h3>
            <div class="list-group">
                @foreach (var reservation in ViewBag.Arrivals as List<HotelManagement.Models.Reservation>)
                {
                    <div class="list-group-item d-flex justify-content-between align-items-center">
                        <div>
                            <strong>@reservation.Room.RoomType.Name</strong> - @reservation.CheckIn.ToShortDateString()
                        </div>
                        <div class="btn-group">
                            <button type="button" class="btn btn-sm btn-info text-white" data-bs-toggle="modal" data-bs-target="#detailsModal-@reservation.Id" title="Szczegóły">
                                <i class="bi bi-info-circle"></i>
                            </button>
                            <a asp-action="Edit" asp-route-id="@reservation.Id" class="btn btn-sm btn-warning">
                                <i class="bi bi-pencil-square"></i> Edytuj
                            </a>
                            <form asp-action="CheckIn" method="post" asp-route-id="@reservation.Id" class="d-inline">
                                <button type="submit" class="btn btn-sm btn-success">Check In</button>
                            </form>
                        </div>
                    </div>

                    <div class="modal fade" id="detailsModal-@reservation.Id" tabindex="-1" aria-labelledby="detailsModalLabel-@reservation.Id" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-scrollable">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="detailsModalLabel-@reservation.Id">Szczegóły rezerwacji</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Zamknij"></button>
                                </div>
                                <div class="modal-body">
                                    <p><strong>Gość:</strong> @reservation.Guest.FirstName @reservation.Guest.LastName</p>
                                    <p><strong>Pokój:</strong> @reservation.Room.Number</p>
                                    <p><strong>Typ pokoju:</strong> @reservation.Room.RoomType.Name</p>
                                    <p><strong>Daty:</strong> @reservation.CheckIn.ToShortDateString() – @reservation.CheckOut.ToShortDateString()</p>
                                    <p><strong>Status:</strong> @reservation.Status</p>
                                    <p><strong>Śniadanie:</strong> @(reservation.Breakfast ? "Tak" : "Nie")</p>
                                    <p><strong>Parking:</strong> @(reservation.Parking ? "Tak" : "Nie")</p>
                                    <p><strong>Dodatkowe łóżko:</strong> @(reservation.ExtraBed ? "Tak" : "Nie")</p>
                                    <p><strong>Cena łączna:</strong> @reservation.TotalPrice zł</p>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Zamknij</button>
                                </div>
                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>


        <!-- Pobyty -->
        <div class="tab-pane fade" id="stay" role="tabpanel" aria-labelledby="stay-tab">
            <h3 class="mt-3">Pobyty</h3>
            <div class="list-group">
                @foreach (var reservation in ViewBag.InStay as List<HotelManagement.Models.Reservation>)
                {
                    <div class="list-group-item d-flex justify-content-between align-items-center">
                        <div>
                            <strong>@reservation.Room.RoomType.Name</strong> -
                            @reservation.CheckIn.ToShortDateString() - @reservation.CheckOut.ToShortDateString()
                        </div>
                        <div class="btn-group">
                            <button type="button" class="btn btn-sm btn-info text-white" data-bs-toggle="modal" data-bs-target="#detailsModal-@reservation.Id" title="Szczegóły">
                                <i class="bi bi-info-circle"></i>
                            </button>
                            <a asp-action="Edit" asp-route-id="@reservation.Id" class="btn btn-sm btn-warning">
                                <i class="bi bi-pencil-square"></i> Edytuj
                            </a>
                        </div>
                    </div>

                    <div class="modal fade" id="detailsModal-@reservation.Id" tabindex="-1" aria-labelledby="detailsModalLabel-@reservation.Id" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-scrollable">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="detailsModalLabel-@reservation.Id">Szczegóły rezerwacji</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Zamknij"></button>
                                </div>
                                <div class="modal-body">
                                    <p><strong>Gość:</strong> @reservation.Guest.FirstName @reservation.Guest.LastName</p>
                                    <p><strong>Pokój:</strong> @reservation.Room.Number</p>
                                    <p><strong>Typ pokoju:</strong> @reservation.Room.RoomType.Name</p>
                                    <p><strong>Daty:</strong> @reservation.CheckIn.ToShortDateString() – @reservation.CheckOut.ToShortDateString()</p>
                                    <p><strong>Status:</strong> @reservation.Status</p>
                                    <p><strong>Śniadanie:</strong> @(reservation.Breakfast ? "Tak" : "Nie")</p>
                                    <p><strong>Parking:</strong> @(reservation.Parking ? "Tak" : "Nie")</p>
                                    <p><strong>Dodatkowe łóżko:</strong> @(reservation.ExtraBed ? "Tak" : "Nie")</p>
                                    <p><strong>Cena łączna:</strong> @reservation.TotalPrice zł</p>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Zamknij</button>
                                </div>
                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>

        <!-- Wyjazdy -->
        <div class="tab-pane fade" id="departures" role="tabpanel" aria-labelledby="departures-tab">
            <h3 class="mt-3">Wyjazdy</h3>
            <div class="list-group">
                @foreach (var reservation in ViewBag.Departures as List<HotelManagement.Models.Reservation>)
                {
                    <div class="list-group-item d-flex justify-content-between align-items-center">
                        <div>
                            <strong>@reservation.Room.RoomType.Name</strong> - @reservation.CheckOut.ToShortDateString()
                        </div>
                        <div class="btn-group">
                            <button type="button" class="btn btn-sm btn-info text-white" data-bs-toggle="modal" data-bs-target="#detailsModal-@reservation.Id" title="Szczegóły">
                                <i class="bi bi-info-circle"></i>
                            </button>
                            <a asp-action="Edit" asp-route-id="@reservation.Id" class="btn btn-sm btn-warning">
                                <i class="bi bi-pencil-square"></i> Edytuj
                            </a>
                            <form asp-action="CheckOut" method="post" asp-route-id="@reservation.Id" class="d-inline">
                                <button type="submit" class="btn btn-sm btn-danger">Check Out</button>
                            </form>
                        </div>
                    </div>

                    <div class="modal fade" id="detailsModal-@reservation.Id" tabindex="-1" aria-labelledby="detailsModalLabel-@reservation.Id" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-scrollable">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="detailsModalLabel-@reservation.Id">Szczegóły rezerwacji</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Zamknij"></button>
                                </div>
                                <div class="modal-body">
                                    <p><strong>Gość:</strong> @reservation.Guest.FirstName @reservation.Guest.LastName</p>
                                    <p><strong>Pokój:</strong> @reservation.Room.Number</p>
                                    <p><strong>Typ pokoju:</strong> @reservation.Room.RoomType.Name</p>
                                    <p><strong>Daty:</strong> @reservation.CheckIn.ToShortDateString() – @reservation.CheckOut.ToShortDateString()</p>
                                    <p><strong>Status:</strong> @reservation.Status</p>
                                    <p><strong>Śniadanie:</strong> @(reservation.Breakfast ? "Tak" : "Nie")</p>
                                    <p><strong>Parking:</strong> @(reservation.Parking ? "Tak" : "Nie")</p>
                                    <p><strong>Dodatkowe łóżko:</strong> @(reservation.ExtraBed ? "Tak" : "Nie")</p>
                                    <p><strong>Cena łączna:</strong> @reservation.TotalPrice zł</p>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Zamknij</button>
                                </div>
                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>

    </div>
</div>
